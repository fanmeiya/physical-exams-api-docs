{
  "openapi": "3.0.0",
  "info": {
    "title": "体检智能分析系统",
    "description": "提供体检报告解读和套餐推荐服务的API",
    "version": "1.0.0"
  },
  "paths": {
    "/companies/{company_code}/packages/{sheet_id}/status": {
      "get": {
        "summary": "Get Package Status",
        "description": "查询单个套餐的处理状态",
        "operationId": "get_package_status_companies__company_code__packages__sheet_id__status_get",
        "parameters": [
          {
            "name": "company_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Company Code"
            }
          },
          {
            "name": "sheet_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Sheet Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PackageStatusResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/companies/{company_code}/packages/manage": {
      "post": {
        "summary": "Manage Company Packages",
        "description": "管理企业体检套餐（更新、删除、暂停、恢复）\n前端传递 sheet_id, status 和 rows 内容\n注意：此接口为同步等待模式，处理完成前不会返回",
        "operationId": "manage_company_packages_companies__company_code__packages_manage_post",
        "parameters": [
          {
            "name": "company_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Company Code"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PackageManagementRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/health_report": {
      "post": {
        "summary": "Health Report",
        "description": "处理健康问卷提交",
        "operationId": "health_report_health_report_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HealthReportRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/interpret_result/{uuid}": {
      "get": {
        "summary": "Get Interpret Result",
        "description": "获取体检报告解读结果",
        "operationId": "get_interpret_result_interpret_result__uuid__get",
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TaskResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/personal_recommendation_result/{uuid}": {
      "get": {
        "summary": "Get Personal Recommendation",
        "description": "获取个性化推荐结果",
        "operationId": "get_personal_recommendation_personal_recommendation_result__uuid__get",
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonalRecommendResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/recommend_result/{uuid}": {
      "get": {
        "summary": "Get Personal Package",
        "description": "获取个人套餐推荐结果",
        "operationId": "get_personal_package_recommend_result__uuid__get",
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonalPackageResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/match_result/{uuid}": {
      "get": {
        "summary": "Get Match Result",
        "description": "获取企业官方套餐匹配结果",
        "operationId": "get_match_result_match_result__uuid__get",
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MatchResultResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/companies/{company_code}/packages/generate": {
      "post": {
        "summary": "Generate Company Packages",
        "description": "企业端生成体检套餐方案",
        "operationId": "generate_company_packages_companies__company_code__packages_generate_post",
        "parameters": [
          {
            "name": "company_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Company Code"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PackageResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/companies/{company_code}/packages/status": {
      "get": {
        "summary": "Get Company Package Status",
        "description": "获取企业套餐生成状态",
        "operationId": "get_company_package_status_companies__company_code__packages_status_get",
        "parameters": [
          {
            "name": "company_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Company Code"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PackageResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/companies/{company_code}/dashboard": {
      "get": {
        "summary": "Get Company Dashboard",
        "description": "企业端查看健康数据看板",
        "operationId": "get_company_dashboard_companies__company_code__dashboard_get",
        "parameters": [
          {
            "name": "company_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Company Code"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DashboardResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/companies/{company_code}/packages/compare": {
      "get": {
        "summary": "Get Company Package Compare",
        "description": "企业端与之前体检套餐的对比分析",
        "operationId": "get_company_package_compare_companies__company_code__packages_compare_get",
        "parameters": [
          {
            "name": "company_code",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Company Code"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CompareResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "summary": "Health Check",
        "description": "健康检查接口",
        "operationId": "health_check_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "CompareResponse": {
        "properties": {
          "code": {
            "type": "integer",
            "title": "Code"
          },
          "compare_analyse": {
            "type": "string",
            "title": "Compare Analyse"
          }
        },
        "type": "object",
        "required": [
          "code",
          "compare_analyse"
        ]
      },
      "DashboardResponse": {
        "properties": {
          "code": {
            "type": "integer",
            "title": "Code"
          },
          "health_data": {
            "type": "string",
            "title": "Health Data"
          }
        },
        "type": "object",
        "required": [
          "code",
          "health_data"
        ]
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object"
      },
      "HealthReportRequest": {
        "properties": {
          "action": {
            "type": "string",
            "title": "Action"
          },
          "uuid": {
            "type": "string",
            "title": "Uuid"
          },
          "name": {
            "title": "Name",
            "default": "未知姓名",
            "type": "string",
            "nullable": true
          },
          "title": {
            "title": "Title",
            "default": "未知标题",
            "type": "string",
            "nullable": true
          },
          "user_id": {
            "title": "User Id",
            "type": "string",
            "nullable": true
          },
          "company_code": {
            "type": "string",
            "title": "Company Code"
          },
          "file_path": {
            "title": "File Path",
            "type": "string",
            "nullable": true
          },
          "gender": {
            "title": "Gender",
            "type": "string",
            "nullable": true
          },
          "age": {
            "title": "Age",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "pulse": {
            "title": "Pulse",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "waistline": {
            "title": "Waistline",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "sbp": {
            "title": "Sbp",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "dbp": {
            "title": "Dbp",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "symptoms": {
            "title": "Symptoms",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "medical_history": {
            "title": "Medical History",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "surgery_history": {
            "title": "Surgery History",
            "type": "string",
            "nullable": true
          },
          "previous_exam_abnormal": {
            "title": "Previous Exam Abnormal",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "lung_nodule_level": {
            "title": "Lung Nodule Level",
            "type": "string",
            "nullable": true
          },
          "hepatic_ct_done": {
            "title": "Hepatic Ct Done",
            "default": "否",
            "type": "string",
            "nullable": true
          },
          "renal_ct_done": {
            "title": "Renal Ct Done",
            "default": "否",
            "type": "string",
            "nullable": true
          },
          "anemia_types": {
            "title": "Anemia Types",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "gastroscopy_done": {
            "title": "Gastroscopy Done",
            "default": "否",
            "type": "string",
            "nullable": true
          },
          "gastroscopy_year": {
            "title": "Gastroscopy Year",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "gastroscopy_result": {
            "title": "Gastroscopy Result",
            "type": "string",
            "nullable": true
          },
          "colonoscopy_done": {
            "title": "Colonoscopy Done",
            "default": "否",
            "type": "string",
            "nullable": true
          },
          "colonoscopy_year": {
            "title": "Colonoscopy Year",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "colonoscopy_result": {
            "title": "Colonoscopy Result",
            "type": "string",
            "nullable": true
          },
          "hpv_screened": {
            "title": "Hpv Screened",
            "default": "否",
            "type": "string",
            "nullable": true
          },
          "hpv_years": {
            "title": "Hpv Years",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "personal_history": {
            "title": "Personal History",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "smoking_years": {
            "title": "Smoking Years",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "smoking_daily": {
            "title": "Smoking Daily",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "smoking_quit": {
            "title": "Smoking Quit",
            "default": "否",
            "type": "string",
            "nullable": true
          },
          "white_liquor_amount": {
            "title": "White Liquor Amount",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "beer_amount": {
            "title": "Beer Amount",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "occupation_traits": {
            "title": "Occupation Traits",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "lifestyle": {
            "title": "Lifestyle",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "diet": {
            "title": "Diet",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "marriage_status": {
            "title": "Marriage Status",
            "default": "否",
            "type": "string",
            "nullable": true
          },
          "marriage_years": {
            "title": "Marriage Years",
            "default": 0,
            "type": "integer",
            "nullable": true
          },
          "family_history": {
            "title": "Family History",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "family_cancer_types": {
            "title": "Family Cancer Types",
            "default": [],
            "type": "array",
            "nullable": true
          },
          "antihypertensive_names": {
            "title": "Antihypertensive Names",
            "type": "string",
            "nullable": true
          },
          "lipidlowering_names": {
            "title": "Lipidlowering Names",
            "type": "string",
            "nullable": true
          },
          "hypoglycemic_names": {
            "title": "Hypoglycemic Names",
            "type": "string",
            "nullable": true
          },
          "longterm_meds": {
            "title": "Longterm Meds",
            "type": "string",
            "nullable": true
          }
        },
        "type": "object",
        "required": [
          "action",
          "uuid",
          "company_code"
        ]
      },
      "MatchResultResponse": {
        "properties": {
          "code": {
            "type": "integer",
            "title": "Code"
          },
          "match_status": {
            "type": "string",
            "title": "Match Status"
          },
          "match_result": {
            "type": "string",
            "title": "Match Result"
          },
          "sheet_id": {
            "type": "string",
            "title": "Sheet Id"
          }
        },
        "type": "object",
        "required": [
          "code",
          "match_status",
          "match_result",
          "sheet_id"
        ]
      },
      "PackageItem": {
        "properties": {
          "sheet_id": {
            "type": "string",
            "title": "Sheet Id"
          },
          "sheet_name": {
            "type": "string",
            "title": "Sheet Name"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "rows": {
            "items": {
              "type": "object"
            },
            "type": "array",
            "title": "Rows"
          }
        },
        "type": "object",
        "required": [
          "sheet_id",
          "sheet_name",
          "status",
          "rows"
        ]
      },
      "PackageManagementRequest": {
        "properties": {
          "packages": {
            "items": {
              "$ref": "#/components/schemas/PackageItem"
            },
            "type": "array",
            "title": "Packages"
          }
        },
        "type": "object",
        "required": [
          "packages"
        ]
      },
      "PackageResponse": {
        "properties": {
          "code": {
            "type": "integer",
            "title": "Code"
          },
          "package_results": {
            "type": "string",
            "title": "Package Results"
          },
          "package_status": {
            "type": "string",
            "title": "Package Status"
          }
        },
        "type": "object",
        "required": [
          "code",
          "package_results",
          "package_status"
        ]
      },
      "PackageStatusResponse": {
        "properties": {
          "sheet_id": {
            "type": "string",
            "title": "Sheet Id"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "message": {
            "type": "string",
            "title": "Message"
          },
          "updated_at": {
            "type": "string",
            "title": "Updated At"
          }
        },
        "type": "object",
        "required": [
          "sheet_id",
          "status",
          "message",
          "updated_at"
        ]
      },
      "PersonalPackageResponse": {
        "properties": {
          "code": {
            "type": "integer",
            "title": "Code"
          },
          "personal_package": {
            "type": "string",
            "title": "Personal Package"
          },
          "assignment_status": {
            "type": "string",
            "title": "Assignment Status"
          }
        },
        "type": "object",
        "required": [
          "code",
          "personal_package",
          "assignment_status"
        ]
      },
      "PersonalRecommendResponse": {
        "properties": {
          "code": {
            "type": "integer",
            "title": "Code"
          },
          "personal_recommendation": {
            "type": "string",
            "title": "Personal Recommendation"
          },
          "recommendation_status": {
            "type": "string",
            "title": "Recommendation Status"
          }
        },
        "type": "object",
        "required": [
          "code",
          "personal_recommendation",
          "recommendation_status"
        ]
      },
      "TaskResponse": {
        "properties": {
          "code": {
            "type": "integer",
            "title": "Code"
          },
          "ai_results": {
            "type": "string",
            "title": "Ai Results"
          },
          "ai_status": {
            "type": "string",
            "title": "Ai Status"
          }
        },
        "type": "object",
        "required": [
          "code",
          "ai_results",
          "ai_status"
        ]
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ]
      }
    }
  }
}